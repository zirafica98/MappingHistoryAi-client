{"ast":null,"code":"import _toConsumableArray from\"/Users/mihajlopetrovic/Desktop/Posao/Markers-Nearby/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/mihajlopetrovic/Desktop/Posao/Markers-Nearby/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/mihajlopetrovic/Desktop/Posao/Markers-Nearby/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/mihajlopetrovic/Desktop/Posao/Markers-Nearby/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/mihajlopetrovic/Desktop/Posao/Markers-Nearby/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import StartFirebase from'../firebaseConfig/firebase';import CustomMarker from'../Marker';import MarkerInf from'../MarkerInf';import{ref,onValue}from'firebase/database';import{jsx as _jsx}from\"react/jsx-runtime\";var db=StartFirebase();export var Data=/*#__PURE__*/function(_React$Component){_inherits(Data,_React$Component);var _super=_createSuper(Data);function Data(props){var _this;_classCallCheck(this,Data);_this=_super.call(this,props);_this.useEffect=function(){var _loop=function _loop(i){setTimeout(function(){return _this.state.setArray(function(prevState){return[].concat(_toConsumableArray(prevState),[i]);});},3000*i);};for(var i=1;i<=3;i++){_loop(i);}};_this.state={error:null,isLoaded:false,items:_this.props.items,data:null,radius:_this.props.radius,counter:0,setArray:null};return _this;}_createClass(Data,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var dbRef=ref(db,'/2/data');onValue(dbRef,function(snapshot){var records=[];snapshot.forEach(function(childSnapshot){var keyName=childSnapshot.key;var data=childSnapshot.val();if(_this2.getDistance([data.long_marker,data.lat],[_this2.state.items[0].lon,_this2.state.items[0].lat])<=_this2.state.radius&&records.length<5){records.push({\"key\":keyName,\"data\":data});}});records.forEach(function(element){if(element.data.bc_ad==\"BC\"){element.data.complateYear=element.data.year*-1;}else{element.data.complateYear=element.data.year;}});records.sort(function(a,b){return parseFloat(a.data.complateYear)-parseFloat(b.data.complateYear);});_this2.setState({data:records});});}},{key:\"getDistance\",value:function getDistance(origin,destination){var lon1=this.toRadian(origin[1]),lat1=this.toRadian(origin[0]),lon2=this.toRadian(destination[1]),lat2=this.toRadian(destination[0]);var deltaLat=lat2-lat1;var deltaLon=lon2-lon1;var a=Math.pow(Math.sin(deltaLat/2),2)+Math.cos(lat1)*Math.cos(lat2)*Math.pow(Math.sin(deltaLon/2),2);var c=2*Math.asin(Math.sqrt(a));var EARTH_RADIUS=6371;return c*EARTH_RADIUS*1000;}},{key:\"toRadian\",value:function toRadian(degree){return degree*Math.PI/180;}},{key:\"sleep\",value:function sleep(delay){var start=new Date().getTime();while(new Date().getTime()<start+delay){;}}},{key:\"render\",value:function render(){if(this.state.data==null){return'Loading...';}else{return/*#__PURE__*/_jsx(CustomMarker,{things:this.state.data});}}}]);return Data;}(React.Component);","map":{"version":3,"names":["React","StartFirebase","CustomMarker","MarkerInf","ref","onValue","db","Data","props","useEffect","i","setTimeout","state","setArray","prevState","error","isLoaded","items","data","radius","counter","dbRef","snapshot","records","forEach","childSnapshot","keyName","key","val","getDistance","long_marker","lat","lon","length","push","element","bc_ad","complateYear","year","sort","a","b","parseFloat","setState","origin","destination","lon1","toRadian","lat1","lon2","lat2","deltaLat","deltaLon","Math","pow","sin","cos","c","asin","sqrt","EARTH_RADIUS","degree","PI","delay","start","Date","getTime","Component"],"sources":["/Users/mihajlopetrovic/Desktop/Posao/Markers-Nearby/src/Data/index.js"],"sourcesContent":["import React from 'react';\nimport StartFirebase from '../firebaseConfig/firebase';\nimport CustomMarker from '../Marker';\nimport MarkerInf from '../MarkerInf';\nimport {ref,onValue} from 'firebase/database'\nconst db = StartFirebase();\nexport class Data extends React.Component {\n      constructor(props) {\n        super(props);\n        this.state = {\n          error: null,\n          isLoaded: false,\n          items: this.props.items,\n          data:null,\n          radius:this.props.radius,\n          counter:0,\n          setArray:null\n\n        }\n      }\n      useEffect= () => {\n        for (let i = 1; i <= 3; i++) {\n          setTimeout(() => this.state.setArray((prevState) => [...prevState, i]), 3000 * i);\n        }\n      };\n      componentDidMount(){\n        const dbRef = ref(db,'/2/data');\n        onValue(dbRef,(snapshot)=>{\n            var records=[]\n            snapshot.forEach(childSnapshot=>{\n                let keyName=childSnapshot.key;\n                let data=childSnapshot.val();\n                if(this.getDistance([data.long_marker,data.lat],[this.state.items[0].lon,this.state.items[0].lat])<=this.state.radius && records.length<5){\n                    records.push({\"key\":keyName,\"data\":data})\n                }\n            })\n\n            records.forEach((element) => {\n                if(element.data.bc_ad==\"BC\"){\n                    element.data.complateYear = element.data.year * (-1)\n                }else{\n                    element.data.complateYear = element.data.year \n                }\n            })\n\n            records.sort(function(a,b){\n                return parseFloat(a.data.complateYear) - parseFloat(b.data.complateYear);\n            })\n\n            this.setState({\n                data: records\n            });\n        })\n    }\n\n\n    getDistance(origin, destination) {\n        var lon1 = this.toRadian(origin[1]),\n            lat1 = this.toRadian(origin[0]),\n            lon2 = this.toRadian(destination[1]),\n            lat2 = this.toRadian(destination[0]);\n    \n        var deltaLat = lat2 - lat1;\n        var deltaLon = lon2 - lon1;\n    \n        var a = Math.pow(Math.sin(deltaLat/2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin(deltaLon/2), 2);\n        var c = 2 * Math.asin(Math.sqrt(a));\n        var EARTH_RADIUS = 6371;\n        return c * EARTH_RADIUS * 1000;\n    }\n    \n    toRadian(degree){\n        return degree*Math.PI/180\n    }\n    sleep(delay) {\n        var start = new Date().getTime();\n        while (new Date().getTime() < start + delay);\n    }\n\n    render() {\n\n        if (this.state.data == null) {\n            return 'Loading...';\n        }else{\n            return (\n                <CustomMarker things={this.state.data}></CustomMarker>\n              );\n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}