{"ast":null,"code":"var _jsxFileName = \"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/src/Data/index.js\";\nimport React from 'react';\nimport StartFirebase from '../firebaseConfig/firebase';\nimport CustomMarker from '../Marker';\nimport { ref, onValue } from 'firebase/database';\nimport CustomMarkerMainCity from '../Marker/CustomMarkerMainCity';\nimport { serverLink } from '../Variable';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst db = StartFirebase();\nexport class Data extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: null,\n      isLoaded: false,\n      items: this.props.items,\n      data: null,\n      radius: this.props.radius,\n      counter: 0,\n      setArray: null,\n      city: this.props.city,\n      question: this.props.question,\n      mainCity: false,\n      event: \"\",\n      image_url: \"\"\n    };\n  }\n\n  async componentDidMount() {\n    var city = this.state.city.toLowerCase();\n\n    if (city === \"london\" || city === \"paris\" || city === \"new york\" || city === \"berlin\" || city === \"roma\") {\n      this.setState({\n        mainCity: true\n      });\n      this.callMyData();\n    } else {\n      const timer = ms => new Promise(res => setTimeout(res, ms));\n\n      for (var i = 0; i <= 10; i++) {\n        if (i === 0) {\n          this.callDataAI(true);\n          await timer(15000);\n        } else {\n          this.callDataAI();\n          await timer(15000);\n        }\n      }\n    }\n  } // async callDataAI(fristTime){\n  //   var prompt;\n  //   if(this.state.question){\n  //     if(fristTime){\n  //       prompt = this.state.question + ' Format for answer JSON{\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"} . Event should be location related ' +this.state.city +'. Return everything in json format in one line.';\n  //     }else{\n  //       prompt = this.state.question + ' Format for answer JSON{\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"} . Event should be location related ' +this.state.city +'. Return everything in json format in one line. Event not to be: '+this.state.event+'';\n  //     }\n  //   }else{\n  //     if(fristTime){\n  //       prompt='Give me interesting historical event for '+ this.state.city+' in the following form {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"} It is mandatory to put quotation marks on the keys in json.Send longitude and latitude as numbers without additional tags.Send longitude and latitude as numbers without additional tags.'\n  //     }else{\n  //       //prompt='Give me another historical interesting event (not to be: '+this.state.event+') for '+ this.state.city+' in the following form {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"}.Send longitude and latitude as numbers without additional tags.'\n  //       prompt='\"Give me a unique historical event for '+this.state.city+', excluding the following events: '+this.state.event+'. Please return the information in the following format: {\"event\":\"???\",\"description\":\"???\", \"date\":\"mm/dd/yyyy\", \"type\":\"\", \"longitude\":???, \"latitude\":???}.\"'\n  //     }\n  //   }\n  //   //serverLink\n  //   const respons = await fetch(serverLink+\"openAi\",{\n  //         method:'POST',\n  //         headers:{\n  //         'Content-Type': 'application/json',\n  //         },\n  //         body: JSON.stringify({\n  //             // prompt: \"Give me the event, description, date in mm/dd/yyyy format, event type for the 5 most interesting historical events within 1 kilometer of the following location: \"+this.state.city+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line, ordered by date. I am only interested in events that happened within 1 km of \"+this.state.city+\". Please check if each event is related to the location I sent you.Please do not repeat the events!\" \n  //             //prompt:\"Give me the Event, Description, Date in mm/dd/yyyy format, Event Type for the 5 most interesting historical events within 1 kilometers of the following location: \"+this.state.city+\". For each historical event, return to me the Longitude and Longitude where that event was located on the map. Return it all to me in json format in one line, ordered by date.\"\n  //           //prompt:\"Give me Event, Description, Date in mm/dd/yyyy format, Event type (birth, death, wars up to 1700, wars from 1701 to 1900, wars from 1901 to 1920, wars from 1921 to 1950 and wars from 1950 to 2021, weather problems) for 5 historical events related to wars, murders, deaths, births, weather problems within \"+localStorage.getItem(\"range\")+\" meters of the following location: \"+this.state.citi+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line and start each key in json with a lowercase letter , sorted by date. I'm only interested in events that happened within 1 km of \"+this.state.city+\". Check that each event is linked to the location I sent you. Do not repeat events!\"\n  //           //prompt:\"Give me the event, description, date in mm/dd/yyyy format and type (best description of that event in 2-3 words ) for 1 historical events within \"+localStorage.getItem(\"range\")+\" meters of the following location: \" + this.state.city+\". For each historical event, return me the longitude and latitude where that event was located on the map. Return everything in json format in one line and start each key in the json with a lowercase letter, sorted by date. I'm only interested in events that happened within 1000 meters of \"+this.state.city+\". Check that each event is linked to the location I sent you. Do not repeat events!\"\n  //           prompt:prompt\n  //         })\n  //       })\n  //       if(respons.ok){\n  //           const data = await respons.json();\n  //           const parsedData = data.response.trim();\n  //           const respons2 = await fetch(serverLink +\"createImages\",{\n  //             method:\"POST\",\n  //             headers:{\n  //             'Content-Type': 'application/json',\n  //             },\n  //             body:JSON.stringify({\n  //               //prompt:JSON.parse(parsedData).event\n  //               prompt:\"Generate an image of \"+JSON.parse(parsedData).event+\" with key figures and elements.\"\n  //             })\n  //           })\n  //           if(respons2.ok){\n  //             const data2 = await respons2.json();\n  //             const parsedData2 = data2.bot;\n  //             if(fristTime){\n  //               this.setState({\n  //                 data: JSON.parse(parsedData),\n  //                 event:JSON.parse(parsedData).event,\n  //                 image_url:parsedData2\n  //               });\n  //               }else{\n  //                 this.setState({\n  //                   data: JSON.parse(parsedData),\n  //                   event:this.state.event+\",\"+JSON.parse(parsedData).event,\n  //                   image_url:parsedData2\n  //                 })\n  //               }\n  //           }\n  //       }else{\n  //           alert(\"error\")\n  //       }\n  // }\n\n\n  async callDataAI(firstTime) {\n    let prompt;\n\n    if (this.state.question) {\n      prompt = this.state.question + ' Format for answer JSON{\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\",\"type\":\"\",\"longitude\":\"???\",\"latitude\":\"???\"}. Event should be location related ' + this.state.city + '. Return everything in json format in one line.';\n\n      if (!firstTime) {\n        prompt += ' Event not to be: ' + this.state.event + '.';\n      }\n    } else {\n      prompt = 'Give me interesting historical event for ' + this.state.city + ' in the following form {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\",\"type\":\"\",\"longitude\":\"???\",\"latitude\":\"???\"}. It is mandatory to put quotation marks on the keys in json. Send longitude and latitude as numbers without additional tags.';\n\n      if (!firstTime) {\n        prompt = `Give me a unique historical event for ${this.state.city}, excluding the following events: ${this.state.event}. Please ensure that the events returned cover a variety of categories (e.g., cultural, political, scientific, etc.). Return the information in the following format: {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\",\"type\":\"\",\"longitude\":???, \"latitude\":???}.`;\n      }\n    }\n\n    const response = await fetch(serverLink + \"openAi\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        prompt\n      })\n    });\n\n    if (!response.ok) {\n      alert(\"Error fetching historical events\");\n      return;\n    }\n\n    const data = await response.json();\n    const parsedData = data.response.trim();\n    const imageResponse = await fetch(serverLink + \"createImages\", {\n      method: \"POST\",\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        prompt: \"Generate an image of \" + JSON.parse(parsedData).event + \" with key figures and elements.\"\n      })\n    });\n\n    if (!imageResponse.ok) {\n      alert(\"Error generating image\");\n      return;\n    }\n\n    const imageData = await imageResponse.json();\n    const imageUrl = imageData.bot;\n    this.setState(prevState => ({\n      data: JSON.parse(parsedData),\n      event: firstTime ? JSON.parse(parsedData).event : prevState.event + \",\" + JSON.parse(parsedData).event,\n      image_url: imageUrl\n    }));\n  }\n\n  async callMyData() {\n    const dbRef = ref(db, '/2/data');\n    onValue(dbRef, snapshot => {\n      var records = [];\n      snapshot.forEach(childSnapshot => {\n        let keyName = childSnapshot.key;\n        let data = childSnapshot.val();\n\n        if (this.getDistance([data.long_marker, data.lat], [this.state.items[0].lon, this.state.items[0].lat]) <= this.state.radius && records.length < 5) {\n          records.push({\n            \"key\": keyName,\n            \"data\": data\n          });\n        }\n      });\n      records.forEach(element => {\n        if (element.data.bc_ad === \"BC\") {\n          element.data.complateYear = element.data.year * -1;\n        } else {\n          element.data.complateYear = element.data.year;\n        }\n      });\n      records.sort(function (a, b) {\n        return parseFloat(a.data.complateYear) - parseFloat(b.data.complateYear);\n      });\n      this.setState({\n        data: records\n      });\n    });\n  }\n\n  getDistance(origin, destination) {\n    var lon1 = this.toRadian(origin[1]),\n        lat1 = this.toRadian(origin[0]),\n        lon2 = this.toRadian(destination[1]),\n        lat2 = this.toRadian(destination[0]);\n    var deltaLat = lat2 - lat1;\n    var deltaLon = lon2 - lon1;\n    var a = Math.pow(Math.sin(deltaLat / 2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin(deltaLon / 2), 2);\n    var c = 2 * Math.asin(Math.sqrt(a));\n    var EARTH_RADIUS = 6371;\n    return c * EARTH_RADIUS * 1000;\n  }\n\n  toRadian(degree) {\n    return degree * Math.PI / 180;\n  }\n\n  sleep(delay) {\n    var start = new Date().getTime();\n\n    while (new Date().getTime() < start + delay);\n  }\n\n  render() {\n    if (this.state.data == null) {\n      return 'Loading...';\n    } else {\n      if (this.state.mainCity) {\n        return /*#__PURE__*/_jsxDEV(CustomMarkerMainCity, {\n          things: this.state.data,\n          image_url: this.state.image_url\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 15\n        }, this);\n      } else {\n        return /*#__PURE__*/_jsxDEV(CustomMarker, {\n          things: this.state.data,\n          image_url: this.state.image_url\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 15\n        }, this);\n      }\n    }\n  }\n\n}","map":{"version":3,"names":["React","StartFirebase","CustomMarker","ref","onValue","CustomMarkerMainCity","serverLink","db","Data","Component","constructor","props","state","error","isLoaded","items","data","radius","counter","setArray","city","question","mainCity","event","image_url","componentDidMount","toLowerCase","setState","callMyData","timer","ms","Promise","res","setTimeout","i","callDataAI","firstTime","prompt","response","fetch","method","headers","body","JSON","stringify","ok","alert","json","parsedData","trim","imageResponse","parse","imageData","imageUrl","bot","prevState","dbRef","snapshot","records","forEach","childSnapshot","keyName","key","val","getDistance","long_marker","lat","lon","length","push","element","bc_ad","complateYear","year","sort","a","b","parseFloat","origin","destination","lon1","toRadian","lat1","lon2","lat2","deltaLat","deltaLon","Math","pow","sin","cos","c","asin","sqrt","EARTH_RADIUS","degree","PI","sleep","delay","start","Date","getTime","render"],"sources":["/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/src/Data/index.js"],"sourcesContent":["import React from 'react';\nimport StartFirebase from '../firebaseConfig/firebase';\nimport CustomMarker from '../Marker';\nimport {ref,onValue} from 'firebase/database'\nimport CustomMarkerMainCity from '../Marker/CustomMarkerMainCity';\nimport { serverLink } from '../Variable';\nconst db = StartFirebase();\nexport class Data extends React.Component {\n      constructor(props) {\n        super(props);\n        this.state = {\n          error: null,\n          isLoaded: false,\n          items: this.props.items,\n          data:null,\n          radius:this.props.radius,\n          counter:0,\n          setArray:null,\n          city:this.props.city,\n          question:this.props.question,\n          mainCity:false,\n          event:\"\",\n          image_url:\"\"\n        }\n      }\n\n      async componentDidMount(){\n        var city = (this.state.city).toLowerCase()\n        if(city === \"london\" || city === \"paris\" || city === \"new york\" || city === \"berlin\" ||  city === \"roma\"){\n          this.setState({\n            mainCity:true\n          })\n          this.callMyData();\n        \n        }else{\n          const timer = ms => new Promise(res => setTimeout(res, ms))\n          for(var i = 0 ; i <= 10 ; i++){\n            if(i===0){\n              this.callDataAI(true);\n              await timer(15000);\n            }else{\n              this.callDataAI();\n              await timer(15000);\n            }\n          }\n        }\n      }\n    \n    \n    // async callDataAI(fristTime){\n    //   var prompt;\n    //   if(this.state.question){\n    //     if(fristTime){\n    //       prompt = this.state.question + ' Format for answer JSON{\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"} . Event should be location related ' +this.state.city +'. Return everything in json format in one line.';\n    //     }else{\n    //       prompt = this.state.question + ' Format for answer JSON{\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"} . Event should be location related ' +this.state.city +'. Return everything in json format in one line. Event not to be: '+this.state.event+'';\n    //     }\n    //   }else{\n    //     if(fristTime){\n    //       prompt='Give me interesting historical event for '+ this.state.city+' in the following form {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"} It is mandatory to put quotation marks on the keys in json.Send longitude and latitude as numbers without additional tags.Send longitude and latitude as numbers without additional tags.'\n    //     }else{\n    //       //prompt='Give me another historical interesting event (not to be: '+this.state.event+') for '+ this.state.city+' in the following form {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\" ,\"type\":\"\",longitude:\"???\",\"latitude\":\"???\"}.Send longitude and latitude as numbers without additional tags.'\n    //       prompt='\"Give me a unique historical event for '+this.state.city+', excluding the following events: '+this.state.event+'. Please return the information in the following format: {\"event\":\"???\",\"description\":\"???\", \"date\":\"mm/dd/yyyy\", \"type\":\"\", \"longitude\":???, \"latitude\":???}.\"'\n    //     }\n    //   }\n    //   //serverLink\n    //   const respons = await fetch(serverLink+\"openAi\",{\n    //         method:'POST',\n    //         headers:{\n    //         'Content-Type': 'application/json',\n    //         },\n    //         body: JSON.stringify({\n    //             // prompt: \"Give me the event, description, date in mm/dd/yyyy format, event type for the 5 most interesting historical events within 1 kilometer of the following location: \"+this.state.city+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line, ordered by date. I am only interested in events that happened within 1 km of \"+this.state.city+\". Please check if each event is related to the location I sent you.Please do not repeat the events!\" \n    //             //prompt:\"Give me the Event, Description, Date in mm/dd/yyyy format, Event Type for the 5 most interesting historical events within 1 kilometers of the following location: \"+this.state.city+\". For each historical event, return to me the Longitude and Longitude where that event was located on the map. Return it all to me in json format in one line, ordered by date.\"\n    //           //prompt:\"Give me Event, Description, Date in mm/dd/yyyy format, Event type (birth, death, wars up to 1700, wars from 1701 to 1900, wars from 1901 to 1920, wars from 1921 to 1950 and wars from 1950 to 2021, weather problems) for 5 historical events related to wars, murders, deaths, births, weather problems within \"+localStorage.getItem(\"range\")+\" meters of the following location: \"+this.state.citi+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line and start each key in json with a lowercase letter , sorted by date. I'm only interested in events that happened within 1 km of \"+this.state.city+\". Check that each event is linked to the location I sent you. Do not repeat events!\"\n    //           //prompt:\"Give me the event, description, date in mm/dd/yyyy format and type (best description of that event in 2-3 words ) for 1 historical events within \"+localStorage.getItem(\"range\")+\" meters of the following location: \" + this.state.city+\". For each historical event, return me the longitude and latitude where that event was located on the map. Return everything in json format in one line and start each key in the json with a lowercase letter, sorted by date. I'm only interested in events that happened within 1000 meters of \"+this.state.city+\". Check that each event is linked to the location I sent you. Do not repeat events!\"\n    //           prompt:prompt\n    //         })\n    //       })\n\n    //       if(respons.ok){\n    //           const data = await respons.json();\n    //           const parsedData = data.response.trim();\n    //           const respons2 = await fetch(serverLink +\"createImages\",{\n    //             method:\"POST\",\n    //             headers:{\n    //             'Content-Type': 'application/json',\n    //             },\n    //             body:JSON.stringify({\n    //               //prompt:JSON.parse(parsedData).event\n    //               prompt:\"Generate an image of \"+JSON.parse(parsedData).event+\" with key figures and elements.\"\n    //             })\n    //           })\n    //           if(respons2.ok){\n    //             const data2 = await respons2.json();\n    //             const parsedData2 = data2.bot;\n    //             if(fristTime){\n    //               this.setState({\n    //                 data: JSON.parse(parsedData),\n    //                 event:JSON.parse(parsedData).event,\n    //                 image_url:parsedData2\n    //               });\n    //               }else{\n    //                 this.setState({\n    //                   data: JSON.parse(parsedData),\n    //                   event:this.state.event+\",\"+JSON.parse(parsedData).event,\n    //                   image_url:parsedData2\n    //                 })\n    //               }\n    //           }\n    //       }else{\n    //           alert(\"error\")\n    //       }\n        \n    // }\n\n    async callDataAI(firstTime) {\n      let prompt;\n  \n      if (this.state.question) {\n          prompt = this.state.question + ' Format for answer JSON{\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\",\"type\":\"\",\"longitude\":\"???\",\"latitude\":\"???\"}. Event should be location related ' + this.state.city + '. Return everything in json format in one line.';\n          \n          if (!firstTime) {\n              prompt += ' Event not to be: ' + this.state.event + '.';\n          }\n      } else {\n          prompt = 'Give me interesting historical event for ' + this.state.city + ' in the following form {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\",\"type\":\"\",\"longitude\":\"???\",\"latitude\":\"???\"}. It is mandatory to put quotation marks on the keys in json. Send longitude and latitude as numbers without additional tags.';\n          \n          if (!firstTime) {\n              prompt = `Give me a unique historical event for ${this.state.city}, excluding the following events: ${this.state.event}. Please ensure that the events returned cover a variety of categories (e.g., cultural, political, scientific, etc.). Return the information in the following format: {\"event\":\"???\",\"description\":\"???\",\"date\":\"mm/dd/yyyy\",\"type\":\"\",\"longitude\":???, \"latitude\":???}.`;\n          }\n      }\n  \n      const response = await fetch(serverLink + \"openAi\", {\n          method: 'POST',\n          headers: {\n              'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ prompt })\n      });\n  \n      if (!response.ok) {\n          alert(\"Error fetching historical events\");\n          return;\n      }\n  \n      const data = await response.json();\n      const parsedData = data.response.trim();\n  \n      const imageResponse = await fetch(serverLink + \"createImages\", {\n          method: \"POST\",\n          headers: {\n              'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n              prompt: \"Generate an image of \" + JSON.parse(parsedData).event + \" with key figures and elements.\"\n          })\n      });\n  \n      if (!imageResponse.ok) {\n          alert(\"Error generating image\");\n          return;\n      }\n  \n      const imageData = await imageResponse.json();\n      const imageUrl = imageData.bot;\n  \n      this.setState(prevState => ({\n          data: JSON.parse(parsedData),\n          event: firstTime ? JSON.parse(parsedData).event : prevState.event + \",\" + JSON.parse(parsedData).event,\n          image_url: imageUrl\n      }));\n  }\n  \n\n\n\n    async callMyData(){\n      const dbRef = ref(db,'/2/data');\n        onValue(dbRef,(snapshot)=>{\n            var records=[]\n            snapshot.forEach(childSnapshot=>{\n                let keyName=childSnapshot.key;\n                let data=childSnapshot.val();\n                if(this.getDistance([data.long_marker,data.lat],[this.state.items[0].lon,this.state.items[0].lat])<=this.state.radius && records.length<5){\n                    records.push({\"key\":keyName,\"data\":data})\n                }\n            })\n\n            records.forEach((element) => {\n                if(element.data.bc_ad===\"BC\"){\n                    element.data.complateYear = element.data.year * (-1)\n                }else{\n                    element.data.complateYear = element.data.year \n                }\n            })\n\n            records.sort(function(a,b){\n                return parseFloat(a.data.complateYear) - parseFloat(b.data.complateYear);\n            })\n\n            this.setState({\n                data: records\n            });\n          })\n    }\n  \n\n\n    getDistance(origin, destination) {\n        var lon1 = this.toRadian(origin[1]),\n            lat1 = this.toRadian(origin[0]),\n            lon2 = this.toRadian(destination[1]),\n            lat2 = this.toRadian(destination[0]);\n    \n        var deltaLat = lat2 - lat1;\n        var deltaLon = lon2 - lon1;\n    \n        var a = Math.pow(Math.sin(deltaLat/2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin(deltaLon/2), 2);\n        var c = 2 * Math.asin(Math.sqrt(a));\n        var EARTH_RADIUS = 6371;\n        return c * EARTH_RADIUS * 1000;\n    }\n    \n    toRadian(degree){\n        return degree*Math.PI/180\n    }\n    sleep(delay) {\n        var start = new Date().getTime();\n        while (new Date().getTime() < start + delay);\n    }\n\n    render() {\n\n        if (this.state.data == null) {\n            return 'Loading...';\n        }else{\n          if(this.state.mainCity) {\n            return (\n              <CustomMarkerMainCity things={this.state.data} image_url={this.state.image_url}></CustomMarkerMainCity>\n            );\n          }else{\n            return (\n              <CustomMarker things={this.state.data} image_url={this.state.image_url}></CustomMarker>\n            );\n          }\n            \n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}