{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _classCallCheck from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import StartFirebase from'../firebaseConfig/firebase';import CustomMarker from'../Marker';import MarkerInf from'../MarkerInf';import{ref,onValue}from'firebase/database';import{jsx as _jsx}from\"react/jsx-runtime\";var db=StartFirebase();export var Data=/*#__PURE__*/function(_React$Component){_inherits(Data,_React$Component);var _super=_createSuper(Data);function Data(props){var _this;_classCallCheck(this,Data);_this=_super.call(this,props);_this.useEffect=function(){var _loop=function _loop(i){setTimeout(function(){return _this.state.setArray(function(prevState){return[].concat(_toConsumableArray(prevState),[i]);});},3000*i);};for(var i=1;i<=3;i++){_loop(i);}};_this.state={error:null,isLoaded:false,items:_this.props.items,data:null,radius:_this.props.radius,counter:0,setArray:null,city:_this.props.city};return _this;}_createClass(Data,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var respons,data,parsedData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('http://localhost:5001/openAi',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({// prompt: \"Give me the event, description, date in mm/dd/yyyy format, event type for the 5 most interesting historical events within 1 kilometer of the following location: \"+this.state.city+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line, ordered by date. I am only interested in events that happened within 1 km of \"+this.state.city+\". Please check if each event is related to the location I sent you.Please do not repeat the events!\" \n//prompt:\"Give me the Event, Description, Date in mm/dd/yyyy format, Event Type for the 5 most interesting historical events within 1 kilometers of the following location: \"+this.state.city+\". For each historical event, return to me the Longitude and Longitude where that event was located on the map. Return it all to me in json format in one line, ordered by date.\"\nprompt:\"Give me Event, Description, Date in mm/dd/yyyy format, Event type (birth, death, wars up to 1700, wars from 1701 to 1900, wars from 1901 to 1920, wars from 1921 to 1950 and wars from 1950 to 2021, weather problems) for 5 historical events related to wars, murders, deaths, births, weather problems within \"+localStorage.getItem(\"range\")+\" meters of the following location: \"+this.state.citi+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line and start each key in json with a lowercase letter , sorted by date. I'm only interested in events that happened within 1 km of \"+this.state.city+\". Check that each event is linked to the location I sent you. Do not repeat events!\"})});case 2:respons=_context.sent;if(!respons.ok){_context.next=12;break;}_context.next=6;return respons.json();case 6:data=_context.sent;parsedData=data.bot.trim();console.log(parsedData);this.setState({data:JSON.parse(parsedData)});_context.next=13;break;case 12:alert(\"error\");case 13:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"getDistance\",value:function getDistance(origin,destination){var lon1=this.toRadian(origin[1]),lat1=this.toRadian(origin[0]),lon2=this.toRadian(destination[1]),lat2=this.toRadian(destination[0]);var deltaLat=lat2-lat1;var deltaLon=lon2-lon1;var a=Math.pow(Math.sin(deltaLat/2),2)+Math.cos(lat1)*Math.cos(lat2)*Math.pow(Math.sin(deltaLon/2),2);var c=2*Math.asin(Math.sqrt(a));var EARTH_RADIUS=6371;return c*EARTH_RADIUS*1000;}},{key:\"toRadian\",value:function toRadian(degree){return degree*Math.PI/180;}},{key:\"sleep\",value:function sleep(delay){var start=new Date().getTime();while(new Date().getTime()<start+delay){;}}},{key:\"render\",value:function render(){if(this.state.data==null){return'Loading...';}else{return/*#__PURE__*/_jsx(CustomMarker,{things:this.state.data});}}}]);return Data;}(React.Component);","map":{"version":3,"names":["React","StartFirebase","CustomMarker","MarkerInf","ref","onValue","db","Data","props","useEffect","i","setTimeout","state","setArray","prevState","error","isLoaded","items","data","radius","counter","city","fetch","method","headers","body","JSON","stringify","prompt","localStorage","getItem","citi","respons","ok","json","parsedData","bot","trim","console","log","setState","parse","alert","origin","destination","lon1","toRadian","lat1","lon2","lat2","deltaLat","deltaLon","a","Math","pow","sin","cos","c","asin","sqrt","EARTH_RADIUS","degree","PI","delay","start","Date","getTime","Component"],"sources":["/Users/mihajlopetrovic/Desktop/Posao/MappingHistory-AI/client-2/src/Data/index.js"],"sourcesContent":["import React from 'react';\nimport StartFirebase from '../firebaseConfig/firebase';\nimport CustomMarker from '../Marker';\nimport MarkerInf from '../MarkerInf';\nimport {ref,onValue} from 'firebase/database'\nconst db = StartFirebase();\nexport class Data extends React.Component {\n      constructor(props) {\n        super(props);\n        this.state = {\n          error: null,\n          isLoaded: false,\n          items: this.props.items,\n          data:null,\n          radius:this.props.radius,\n          counter:0,\n          setArray:null,\n          city:this.props.city\n\n        }\n      }\n      useEffect= () => {\n        for (let i = 1; i <= 3; i++) {\n          setTimeout(() => this.state.setArray((prevState) => [...prevState, i]), 3000 * i);\n        }\n      };\n      async componentDidMount(){\n        // const dbRef = ref(db,'/2/data');\n        // onValue(dbRef,(snapshot)=>{\n        //     var records=[]\n        //     snapshot.forEach(childSnapshot=>{\n        //         let keyName=childSnapshot.key;\n        //         let data=childSnapshot.val();\n        //         if(this.getDistance([data.long_marker,data.lat],[this.state.items[0].lon,this.state.items[0].lat])<=this.state.radius && records.length<5){\n        //             records.push({\"key\":keyName,\"data\":data})\n        //         }\n        //     })\n\n        //     records.forEach((element) => {\n        //         if(element.data.bc_ad==\"BC\"){\n        //             element.data.complateYear = element.data.year * (-1)\n        //         }else{\n        //             element.data.complateYear = element.data.year \n        //         }\n        //     })\n\n        //     records.sort(function(a,b){\n        //         return parseFloat(a.data.complateYear) - parseFloat(b.data.complateYear);\n        //     })\n\n        //     this.setState({\n        //         data: records\n        //     });\n        // })\n\n        const respons = await fetch('http://localhost:5001/openAi',{\n            method:'POST',\n            headers:{\n            'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                // prompt: \"Give me the event, description, date in mm/dd/yyyy format, event type for the 5 most interesting historical events within 1 kilometer of the following location: \"+this.state.city+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line, ordered by date. I am only interested in events that happened within 1 km of \"+this.state.city+\". Please check if each event is related to the location I sent you.Please do not repeat the events!\" \n                //prompt:\"Give me the Event, Description, Date in mm/dd/yyyy format, Event Type for the 5 most interesting historical events within 1 kilometers of the following location: \"+this.state.city+\". For each historical event, return to me the Longitude and Longitude where that event was located on the map. Return it all to me in json format in one line, ordered by date.\"\n              prompt:\"Give me Event, Description, Date in mm/dd/yyyy format, Event type (birth, death, wars up to 1700, wars from 1701 to 1900, wars from 1901 to 1920, wars from 1921 to 1950 and wars from 1950 to 2021, weather problems) for 5 historical events related to wars, murders, deaths, births, weather problems within \"+localStorage.getItem(\"range\")+\" meters of the following location: \"+this.state.citi+\". For each historical event, return me the longitude and the longitude where that event was located on the map. Return everything in json format in one line and start each key in json with a lowercase letter , sorted by date. I'm only interested in events that happened within 1 km of \"+this.state.city+\". Check that each event is linked to the location I sent you. Do not repeat events!\"\n            })\n        })\n\n        if(respons.ok){\n            const data = await respons.json();\n            const parsedData = data.bot.trim();\n            console.log(parsedData);\n            this.setState({\n                data: JSON.parse(parsedData)\n            });\n          }else{\n            alert(\"error\")\n          }\n    }\n\n\n    getDistance(origin, destination) {\n        var lon1 = this.toRadian(origin[1]),\n            lat1 = this.toRadian(origin[0]),\n            lon2 = this.toRadian(destination[1]),\n            lat2 = this.toRadian(destination[0]);\n    \n        var deltaLat = lat2 - lat1;\n        var deltaLon = lon2 - lon1;\n    \n        var a = Math.pow(Math.sin(deltaLat/2), 2) + Math.cos(lat1) * Math.cos(lat2) * Math.pow(Math.sin(deltaLon/2), 2);\n        var c = 2 * Math.asin(Math.sqrt(a));\n        var EARTH_RADIUS = 6371;\n        return c * EARTH_RADIUS * 1000;\n    }\n    \n    toRadian(degree){\n        return degree*Math.PI/180\n    }\n    sleep(delay) {\n        var start = new Date().getTime();\n        while (new Date().getTime() < start + delay);\n    }\n\n    render() {\n\n        if (this.state.data == null) {\n            return 'Loading...';\n        }else{\n            return (\n                <CustomMarker things={this.state.data}></CustomMarker>\n              );\n        }\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}